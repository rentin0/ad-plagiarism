<div class="flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-purple-100 to-pink-100 p-8">
  <div class="mb-8 text-center">
    <h1 class="text-4xl font-bold text-gray-800 mb-2">ç”»åƒãƒ‘ã‚ºãƒ«ã‚²ãƒ¼ãƒ </h1>
    <p class="text-gray-600">ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ãƒ”ãƒ¼ã‚¹ã‚’ä¸¦ã¹æ›¿ãˆã¦ç”»åƒã‚’å®Œæˆã•ã›ã‚ˆã†ï¼</p>
  </div>

  @if (isCompleted()) {
    <div class="mb-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg animate-bounce">
      <span class="text-xl font-bold">ğŸ‰ ã‚¯ãƒªã‚¢ï¼ãŠã‚ã§ã¨ã†ï¼</span>
    </div>
  }

  <!-- é€²æ—ã‚²ãƒ¼ã‚¸ -->
  <div class="w-full max-w-2xl mb-6">
    @if (isLoading()) {
      <div class="flex flex-col items-center gap-2">
        <p-skeleton width="100%" height="1.5rem" borderRadius="16px"></p-skeleton>
      </div>
    } @else {
      <p-progressBar
        [value]="progressValue"
        [showValue]="true"
      ></p-progressBar>
    }
  </div>

  <!-- ãƒ‘ã‚ºãƒ«ã‚¨ãƒªã‚¢ -->
  <div
    class="relative bg-white p-4 rounded-xl shadow-2xl"
    [style.width.px]="(pieceSize + pieceGap) * gridSize - pieceGap + 32"
    [style.height.px]="(pieceSize + pieceGap) * gridSize - pieceGap + 32"
  >
    @if (isLoading()) {
      <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­ã®ã‚¹ã‚±ãƒ«ãƒˆãƒ³ -->
      <div class="grid grid-cols-3 gap-2">
        @for (i of [0,1,2,3,4,5,6,7,8]; track i) {
          <p-skeleton width="146px" height="146px"></p-skeleton>
        }
      </div>
    } @else {
      <!-- ã‚°ãƒªãƒƒãƒ‰ã‚¬ã‚¤ãƒ‰ï¼ˆè–„ã„ç·šï¼‰ -->
      <div class="absolute inset-4 pointer-events-none">
        <div class="grid grid-cols-3 h-full">
          @for (i of [0,1,2,3,4,5,6,7,8]; track i) {
            <div class="border border-gray-200"></div>
          }
        </div>
      </div>
    }

    <!-- SVGå®šç¾©ï¼ˆã‚¯ãƒªãƒƒãƒ—ãƒ‘ã‚¹ï¼‰ -->
    <svg class="absolute w-0 h-0">
      <defs>
        @for (piece of pieces(); track piece.id) {
          <clipPath [id]="'puzzle-clip-' + piece.id">
            <path [attr.d]="getPuzzlePath(piece)" />
          </clipPath>
        }
      </defs>
    </svg>

    <!-- ãƒ‘ã‚ºãƒ«ãƒ”ãƒ¼ã‚¹ -->
    @for (piece of pieces(); track piece.id) {
      <app-puzzle-piece
        [piece]="piece"
        [pieceSize]="pieceSize"
        [gridSize]="gridSize"
        [pieceGap]="pieceGap"
        [snapThreshold]="snapThreshold"
        [isAnimating]="isAnimating()"
        [showHint]="showHint()"
        (positionChanged)="onPositionChanged($event)"
        (bringToFront)="bringToFront(piece)"
      />
    }
  </div>

  <p-button
    (onClick)="reset()"
    [disabled]="isLoading()"
    icon="pi pi-refresh"
    [rounded]="true"
    severity="info"
    class="mt-8"
  />
</div>
